# Test one group
p_distinct_posterior(r=1,k=3, m_j = c(2,2), n_j = c(2,2), gamma = c(2,2), prior = "Poisson", lambda = 2, Max_iter = 100)
p_distinct_prior(k=1, n_j = 3, gamma = 2, prior = "Poisson", lambda = 2, Max_iter = 1000)

0.08390593 +

n = 250
tot = 0
for(i in 0:n){
  pp = p_distinct_prior(k=i, n_j = n, gamma = 2, prior = "Poisson", lambda = 2, Max_iter = 1000)
  print(pp)
  tot = tot + pp
}
tot

log_qm = c(-13.1604, -14.4662, -16.0941, -17.8821, -19.7805, -21.7669, -23.8287, -25.9577, -28.1481, -30.3952, -32.6955, -35.0458, -37.4435, -39.8862, -42.3719, -44.8987, -47.465, -50.0691, -52.7096, -55.3853, -58.0949, -60.8372, -63.6114, -66.4162, -69.2509, -72.1146, -75.0064, -77.9256, -80.8713, -83.8431, -86.8401, -89.8617, -92.9074, -95.9766, -99.0688, -102.183, -105.32, -108.478, -111.657, -114.857, -118.076, -121.316, -124.575, -127.853, -131.15, -134.465, -137.798, -141.148, -144.516, -147.901, -151.303, -154.722, -158.156, -161.607, -165.073, -168.555, -172.052, -175.564, -179.091, -182.633, -186.189, -189.759, -193.343, -196.94, -200.552, -204.177, -207.815, -211.466, -215.13, -218.807, -222.496, -226.198, -229.911, -233.638, -237.376, -241.125, -244.887, -248.66, -252.445, -256.241, -260.048, -263.866, -267.695, -271.534, -275.385, -279.246, -283.117, -286.999, -290.891, -294.793, -298.706, -302.628, -306.56, -310.502, -314.453, -318.415, -322.385, -326.365, -330.354, -334.353)
qm = exp(log_qm)
sum(qm)
log(sum(qm))

log_norm_const = -6.00802
exp(log_norm_const)
